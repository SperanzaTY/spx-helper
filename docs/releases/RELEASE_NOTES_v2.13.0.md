# SPX Helper v2.13.0 发布说明

## 🎉 新增功能

### 1. 文本选取功能开关 ⚡
**问题：** 文本选取浮动按钮可能会干扰日常工作  
**解决：** 添加开关，可随时开启/关闭

**功能特性：**
- ✅ 默认开启，避免影响现有用户习惯
- ✅ 一键切换，立即生效
- ✅ 多标签页实时同步
- ✅ 状态持久化保存

**使用方式：**
1. 打开扩展弹窗
2. 进入 **🔧 实用工具** → **App 工具** → **🔍 API 数据溯源**
3. 在 **⚙️ 功能设置** 区域切换开关

---

### 2. API 过滤条件自定义 🎯
**问题：** 拦截所有包含 `api_mart` 的接口，不够灵活  
**解决：** 支持自定义过滤关键词

**功能特性：**
- ✅ 默认只拦截 `api_mart` 接口
- ✅ 支持多个关键词（逗号分隔）
- ✅ 支持特殊字符（如 `/`, `?`, `=`）
- ✅ 留空则拦截所有接口
- ✅ 减少性能开销

**配置示例：**
```
api_mart                    → 只拦截 api_mart 接口
api_mart, /api/            → 拦截多个关键词
api_mart, /api/bff/, graphql → 拦截 BFF 和 GraphQL
(留空)                      → 拦截所有接口
```

**使用方式：**
1. 在 API 溯源工具中找到 "API 过滤条件" 输入框
2. 填写关键词（逗号分隔）
3. 点击 "💾 保存过滤条件"
4. 刷新页面生效

---

## 🎨 UI/UX 优化

### 设置区域重新设计
- 新增 **⚙️ 功能设置** 区域，集中管理所有配置
- 使用 Toggle Switch 开关，交互更直观
- 添加说明文字，降低理解成本
- 保存后显示提示，明确告知需要刷新页面

### 使用说明优化
- 更新 API 溯源工具的功能介绍
- 移除 "需要开启检查器" 的误导性说明
- 强调 "可自定义过滤条件"

---

## 🛠️ 技术改进

### 架构优化
```
Popup.js (设置界面)
    ↓ chrome.storage.local
Content.js (读取设置)
    ↓ window.postMessage
Injected.js (应用过滤)
    ↓ 拦截 API
Page (网页)
```

### 消息通信
- Popup → Content: `UPDATE_TEXT_SELECTION_STATE`
- Content → Injected: `SPX_UPDATE_API_FILTER`

### 数据持久化
```javascript
{
  textSelectionEnabled: true,      // 文本选取开关
  apiFilterKeywords: "api_mart"    // 过滤关键词
}
```

---

## 📊 性能影响

### 高性能配置（推荐）
**配置：** `api_mart`  
**拦截量：** 5-10 个接口  
**性能影响：** 几乎无感知  
**适用场景：** 日常开发

### 平衡配置
**配置：** `api_mart, /api/v2/, /api/bff/`  
**拦截量：** 15-30 个接口  
**性能影响：** 轻微  
**适用场景：** 全栈调试

### 全量配置（不推荐）
**配置：** 留空  
**拦截量：** 50+ 个接口  
**性能影响：** 明显卡顿  
**适用场景：** 临时全量分析

---

## 🐛 Bug 修复

### 之前的问题
1. 文本选取功能无法关闭，可能干扰工作
2. API 过滤条件硬编码，不灵活
3. 拦截过多不需要的接口，影响性能

### 现在的改进
1. ✅ 可随时开关文本选取功能
2. ✅ 可自定义过滤条件
3. ✅ 减少不必要的拦截，提升性能

---

## 📖 文档更新

### 新增文档
1. `API_TRACKER_SETTINGS_GUIDE.md` - 设置功能使用指南
2. `API_TRACKER_SETTINGS_TEST.md` - 完整的测试清单

### 更新文档
1. `CHANGELOG.md` - 添加 v2.13.0 更新日志
2. `README.md` - 更新功能列表（待更新）

---

## 🚀 升级指南

### 从 v2.12.0 升级到 v2.13.0

1. **重新加载扩展**
   ```
   chrome://extensions/ → 刷新 SPX Helper
   ```

2. **检查默认设置**
   - 文本选取功能：默认开启 ✅
   - API 过滤条件：`api_mart`

3. **根据需求调整**
   - 不需要文本选取功能？→ 关闭开关
   - 需要拦截更多接口？→ 修改过滤条件

4. **刷新页面**
   ```
   让新配置生效
   ```

---

## 🎯 下一步计划

### 即将推出的功能
- [ ] 过滤条件支持正则表达式
- [ ] API 拦截记录导出（JSON/CSV）
- [ ] 自动清理过期的 API 记录
- [ ] API 响应数据对比工具

---

## 📞 反馈渠道

如果遇到问题或有建议，请：
1. 查看 `API_TRACKER_SETTINGS_GUIDE.md` 常见问题
2. 运行 `API_TRACKER_SETTINGS_TEST.md` 测试清单
3. 联系开发者反馈

---

## 版本信息
- **版本号：** v2.13.0
- **发布日期：** 2024
- **兼容性：** Chrome/Edge 88+
- **上一版本：** v2.12.0

---

## 致谢
感谢所有提供反馈和建议的用户！🎉
