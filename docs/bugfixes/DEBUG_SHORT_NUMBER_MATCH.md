# ğŸ› çŸ­æ•°å­—åŒ¹é…é—®é¢˜è°ƒè¯•

## âŒ é—®é¢˜ç°è±¡

```javascript
è¦åŒ¹é…çš„æ–‡æœ¬: ['104']
ğŸ“Š æ€»å…±æ‰¾åˆ° 0 ä¸ªæ•°æ®æ¥æº  // âŒ åŒ¹é…å¤±è´¥
```

---

## ğŸ” é—®é¢˜åŸå› åˆ†æ

### åŸä»£ç çš„è‡´å‘½ Bug

```javascript
// content.js Line 308 (æ—§ç‰ˆæœ¬)
if (!searchText || searchText.length < 2) return false;
```

**é—®é¢˜**ï¼š
- âŒ æ‹’ç»æ‰€æœ‰**é•¿åº¦å°äº 2** çš„æ–‡æœ¬
- âŒ å•å­—ç¬¦ï¼ˆå¦‚ `1`, `A`ï¼‰æ— æ³•åŒ¹é…
- âŒ è™½ç„¶ `104` æœ‰ 3 ä½å¯ä»¥é€šè¿‡ï¼Œä½†è¿™ä¸ªé™åˆ¶å¤ªä¸¥æ ¼äº†

### ä¸ºä»€ä¹ˆè®¾ç½® `length < 2` é™åˆ¶ï¼Ÿ

**åŸæ„**ï¼šé¿å…åŒ¹é…è¿‡äºå®½æ³›ï¼ˆå¦‚å•å­—ç¬¦ `a` ä¼šåŒ¹é…å¾ˆå¤šå†…å®¹ï¼‰

**å®é™…é—®é¢˜**ï¼š
- âœ… é¿å…äº†è¯¯åŒ¹é…
- âŒ ä½†ä¹Ÿé˜»æ­¢äº†**åˆæ³•çš„çŸ­æ•°å­—**ï¼ˆå¦‚ç«™ç‚¹ ID `104`ï¼‰

---

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. æ”¾å®½é•¿åº¦é™åˆ¶

```javascript
// æ”¹ä¸ºï¼š
if (!searchText || searchText.length < 1) return false;

// æˆ–è€…å®Œå…¨ç§»é™¤é•¿åº¦é™åˆ¶ï¼š
if (!searchText) return false;
```

**æ•ˆæœ**ï¼š
- âœ… å…è®¸æ‰€æœ‰é•¿åº¦çš„æ–‡æœ¬
- âœ… çŸ­æ•°å­— `104` å¯ä»¥åŒ¹é…
- âš ï¸ å¯èƒ½ä¼šæœ‰æ›´å¤šè¯¯åŒ¹é…ï¼ˆä½†å¯ä»¥æ¥å—ï¼‰

### 2. å¢å¼ºè°ƒè¯•æ¨¡å¼

æ·»åŠ  `debug` å‚æ•°åˆ° `searchInObject`ï¼š

```javascript
searchInObject(obj, searchText, depth = 0, debug = false) {
  if (debug) {
    console.log(`[å­—ç¬¦ä¸²] æ¯”è¾ƒ "${obj}" vs "${searchText}"`);
    console.log(`[ç­–ç•¥1-æ–‡æœ¬] ç²¾ç¡®åŒ¹é…: ${result}`);
    console.log(`[ç­–ç•¥2-æ ‡å‡†åŒ–] "${searchNormalized}" vs "${objNormalized}"`);
    // ... æ›´å¤šè°ƒè¯•ä¿¡æ¯
  }
  // ... åŒ¹é…é€»è¾‘
}
```

**å¥½å¤„**ï¼š
- âœ… å¯ä»¥çœ‹åˆ°**æ¯ä¸ªåŒ¹é…ç­–ç•¥**çš„æ‰§è¡Œè¿‡ç¨‹
- âœ… å¯ä»¥çœ‹åˆ°**ä¸ºä»€ä¹ˆåŒ¹é…å¤±è´¥**
- âœ… å¿«é€Ÿå®šä½é—®é¢˜

---

## ğŸ§ª è°ƒè¯•æ­¥éª¤

### 1. é‡æ–°åŠ è½½æ‰©å±•

```bash
chrome://extensions/
â†’ SPX Helper
â†’ ğŸ”„ é‡æ–°åŠ è½½
```

### 2. æ‰“å¼€æ‰©å±•å¹¶å¯åŠ¨ API æº¯æº

```bash
æ‰©å±• â†’ å®ç”¨å·¥å…· â†’ APIæº¯æº â†’ å¯åŠ¨æ£€æŸ¥å™¨
```

### 3. Hover åˆ°åŒ…å« `104` çš„å…ƒç´ 

**Console ä¼šæ˜¾ç¤ºè¯¦ç»†æ—¥å¿—**ï¼š

```javascript
ğŸ” [SPX Helper] å¼€å§‹æŸ¥æ‰¾æ•°æ®æ¥æº
   Content Script ä¸­çš„ API æ•°é‡: 22
   è¦åŒ¹é…çš„æ–‡æœ¬: ['104']

   ğŸ” æ£€æŸ¥ API: https://xxx/api_mart/...
      å“åº”æ•°æ®ç±»å‹: object
      å“åº”æ•°æ®é¢„è§ˆ: {"retcode":0,"data":{"list":[{"station_id":104,...
      
      â†’ å°è¯•åŒ¹é…æ–‡æœ¬: "104"
         [å­—ç¬¦ä¸²] æ¯”è¾ƒ "104" vs "104"
         âœ… [ç­–ç•¥1-æ–‡æœ¬] ç²¾ç¡®åŒ¹é…æˆåŠŸ  // â† å…³é”®ä¿¡æ¯
         
         åŒ¹é…ç»“æœ: true
         
   âœ… æ‰¾åˆ°åŒ¹é…: https://xxx/api_mart/... åŒ¹é…æ–‡æœ¬: ['104']
   ğŸ“Š æ€»å…±æ‰¾åˆ° 1 ä¸ªæ•°æ®æ¥æº
```

---

## ğŸ“Š æ–°çš„è°ƒè¯•æ—¥å¿—è¯´æ˜

### 1. API çº§åˆ«çš„æ—¥å¿—

```javascript
ğŸ” æ£€æŸ¥ API: https://xxx/api_mart/...
   å“åº”æ•°æ®ç±»å‹: object
   å“åº”æ•°æ®é¢„è§ˆ: {"retcode":0,"data":...
```

**ä¿¡æ¯**ï¼š
- æ­£åœ¨æ£€æŸ¥å“ªä¸ª API
- å“åº”æ•°æ®çš„ç±»å‹
- å“åº”æ•°æ®çš„å‰ 200 ä¸ªå­—ç¬¦

### 2. æ–‡æœ¬åŒ¹é…çº§åˆ«çš„æ—¥å¿—

```javascript
â†’ å°è¯•åŒ¹é…æ–‡æœ¬: "104"
   åŒ¹é…ç»“æœ: true/false
```

**ä¿¡æ¯**ï¼š
- å½“å‰å°è¯•åŒ¹é…çš„æ–‡æœ¬
- æœ€ç»ˆåŒ¹é…ç»“æœ

### 3. ç­–ç•¥çº§åˆ«çš„æ—¥å¿—ï¼ˆdebug æ¨¡å¼ï¼‰

```javascript
[å­—ç¬¦ä¸²] æ¯”è¾ƒ "104" vs "104"
âœ… [ç­–ç•¥1-æ–‡æœ¬] ç²¾ç¡®åŒ¹é…æˆåŠŸ

[æ•°å­—] æ¯”è¾ƒ 104 (104) vs "104"
âœ… [ç­–ç•¥1-ç²¾ç¡®] åŒ¹é…æˆåŠŸ

[ç­–ç•¥2-æ ‡å‡†åŒ–] "104" vs "104"
âœ… [ç­–ç•¥2-æ ‡å‡†åŒ–] åŒ¹é…æˆåŠŸ

[ç­–ç•¥3-çº¯æ•°å­—] "104" vs "104"
âœ… [ç­–ç•¥3-çº¯æ•°å­—] åŒ¹é…æˆåŠŸ
```

**ä¿¡æ¯**ï¼š
- ä½¿ç”¨å“ªä¸ªç­–ç•¥
- æ¯”è¾ƒçš„å…·ä½“å€¼
- æ˜¯å¦åŒ¹é…æˆåŠŸ

---

## ğŸ¯ åŒ¹é…ç­–ç•¥è¯¦è§£

### ç­–ç•¥ 1: ç²¾ç¡®æ–‡æœ¬åŒ¹é…

```javascript
// å­—ç¬¦ä¸²åŒ…å«
"station_id: 104".includes("104")  // âœ… true
```

### ç­–ç•¥ 2: æ ‡å‡†åŒ–æ•°å­—åŒ¹é…

```javascript
normalizeNumber("1,234.56")  // "1234.56"
normalizeNumber("1.234,56")  // "1234.56"
normalizeNumber("104")       // "104"
```

### ç­–ç•¥ 3: çº¯æ•°å­—æ¨¡ç³ŠåŒ¹é…

```javascript
extractDigitsOnly("1,234.56")  // "123456"
extractDigitsOnly("9.732")     // "9732"
extractDigitsOnly("104")       // "104"
```

### ç­–ç•¥ 4: å­—ç¬¦ä¸²æ¨¡ç³ŠåŒ¹é…

```javascript
normalizeString("Jakarta-Hub")  // "jakartahub"
normalizeString("Jakarta_Hub")  // "jakartahub"
normalizeString("JAKARTA HUB")  // "jakartahub"
```

---

## ğŸ‰ æµ‹è¯•æ¡ˆä¾‹

### æ¡ˆä¾‹ 1: çŸ­æ•°å­—ï¼ˆå¦‚ `104`ï¼‰

**å…ƒç´ æ–‡æœ¬**ï¼š`104`

**API å“åº”**ï¼š
```json
{
  "data": {
    "list": [
      {"station_id": 104, "name": "Station A"}
    ]
  }
}
```

**åŒ¹é…è¿‡ç¨‹**ï¼š
1. æ£€æŸ¥ `station_id` å­—æ®µ
2. ç±»å‹ï¼š`number` â†’ å€¼ `104`
3. è½¬ä¸ºå­—ç¬¦ä¸²ï¼š`"104"`
4. ç­–ç•¥ 1 ç²¾ç¡®åŒ¹é…ï¼š`"104" === "104"` âœ…
5. **åŒ¹é…æˆåŠŸ**

### æ¡ˆä¾‹ 2: æ ¼å¼åŒ–æ•°å­—ï¼ˆå¦‚ `9.732`ï¼‰

**å…ƒç´ æ–‡æœ¬**ï¼š`9.732`ï¼ˆå®é™…æ˜¯ `9732`ï¼Œç”¨ç‚¹ä½œä¸ºåƒä½åˆ†éš”ç¬¦ï¼‰

**API å“åº”**ï¼š
```json
{
  "data": {
    "total": 9732
  }
}
```

**åŒ¹é…è¿‡ç¨‹**ï¼š
1. æ£€æŸ¥ `total` å­—æ®µ
2. ç±»å‹ï¼š`number` â†’ å€¼ `9732`
3. ç­–ç•¥ 1 ç²¾ç¡®åŒ¹é…ï¼š`"9732" !== "9.732"` âŒ
4. ç­–ç•¥ 2 æ ‡å‡†åŒ–ï¼š`"9732" !== "9.732"` âŒï¼ˆä¿ç•™å°æ•°ç‚¹ï¼‰
5. **ç­–ç•¥ 3 çº¯æ•°å­—**ï¼š`"9732" === "9732"` âœ…
6. **åŒ¹é…æˆåŠŸ**

### æ¡ˆä¾‹ 3: å­—ç¬¦ä¸²ï¼ˆå¦‚ `Jakarta Hub`ï¼‰

**å…ƒç´ æ–‡æœ¬**ï¼š`Jakarta Hub`

**API å“åº”**ï¼š
```json
{
  "data": {
    "hub_name": "jakarta-hub"
  }
}
```

**åŒ¹é…è¿‡ç¨‹**ï¼š
1. æ£€æŸ¥ `hub_name` å­—æ®µ
2. ç±»å‹ï¼š`string` â†’ å€¼ `"jakarta-hub"`
3. ç­–ç•¥ 1 ç²¾ç¡®ï¼š`"jakarta-hub".includes("jakarta hub")` âŒ
4. **ç­–ç•¥ 4 å­—ç¬¦ä¸²**ï¼š`normalizeString("jakarta-hub") === "jakartahub"`, `normalizeString("Jakarta Hub") === "jakartahub"` âœ…
5. **åŒ¹é…æˆåŠŸ**

---

## ğŸš€ ç°åœ¨æµ‹è¯•

```bash
1ï¸âƒ£ é‡æ–°åŠ è½½æ‰©å±•
2ï¸âƒ£ æ‰“å¼€ç½‘é¡µï¼ˆå¦‚ FMS ç«™ç‚¹åˆ—è¡¨é¡µï¼‰
3ï¸âƒ£ æ‰“å¼€æ‰©å±• â†’ APIæº¯æº â†’ å¯åŠ¨æ£€æŸ¥å™¨
4ï¸âƒ£ Hover åˆ°åŒ…å«çŸ­æ•°å­—çš„å…ƒç´ ï¼ˆå¦‚ç«™ç‚¹ ID `104`ï¼‰
5ï¸âƒ£ æŸ¥çœ‹ Console (F12)
   â†’ åº”è¯¥çœ‹åˆ°è¯¦ç»†çš„åŒ¹é…æ—¥å¿—
   â†’ åº”è¯¥çœ‹åˆ° "âœ… æ‰¾åˆ°åŒ¹é…" æˆ–åŒ¹é…å¤±è´¥çš„åŸå› 
```

---

## ğŸ’¡ å¦‚æœè¿˜æ˜¯åŒ¹é…ä¸ä¸Š

### æ£€æŸ¥ 1: API å“åº”é‡Œæœ‰æ²¡æœ‰è¿™ä¸ªæ•°å­—ï¼Ÿ

```javascript
// åœ¨ Console æŸ¥çœ‹ï¼š
ğŸ” æ£€æŸ¥ API: https://xxx/api_mart/...
   å“åº”æ•°æ®é¢„è§ˆ: {"retcode":0,"data":...
```

**æ‰‹åŠ¨æŸ¥æ‰¾**ï¼š
1. å¤åˆ¶ API URL
2. åœ¨ Network é¢æ¿æ‰¾åˆ°è¿™ä¸ªè¯·æ±‚
3. æŸ¥çœ‹ Response
4. æœç´¢ `104` â†’ çœ‹çœ‹æ˜¯å¦å­˜åœ¨

### æ£€æŸ¥ 2: æ•°æ®åµŒå¥—å¤ªæ·±ï¼Ÿ

```javascript
// å½“å‰æ·±åº¦é™åˆ¶ï¼šdepth > 3
if (depth > 3) {
  console.log(`[æ·±åº¦é™åˆ¶] æ·±åº¦ ${depth} è¶…è¿‡ 3ï¼Œåœæ­¢æœç´¢`);
  return false;
}
```

**å¦‚æœæ•°æ®åµŒå¥—è¶…è¿‡ 3 å±‚**ï¼š
```json
{
  "data": {           // depth 0
    "result": {       // depth 1
      "items": {      // depth 2
        "list": {     // depth 3
          "values": [ // depth 4 âŒ è¶…è¿‡é™åˆ¶
            {"id": 104}
          ]
        }
      }
    }
  }
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼šå¢åŠ æ·±åº¦é™åˆ¶
```javascript
if (depth > 5) return false;  // æ”¹ä¸º 5 æˆ–æ›´å¤§
```

### æ£€æŸ¥ 3: å­—æ®µåç§°åŒ¹é…ï¼Ÿ

**å¦‚æœä½ æƒ³åŒæ—¶åŒ¹é…å­—æ®µå**ï¼š

```json
{
  "station_104": "Some Value"
}
```

éœ€è¦ä¿®æ”¹ä»£ç ï¼š
```javascript
if (obj && typeof obj === 'object') {
  // æ£€æŸ¥å€¼
  const valueMatch = Object.values(obj).some(value => 
    this.searchInObject(value, searchText, depth + 1, debug)
  );
  
  // æ£€æŸ¥é”®å
  const keyMatch = Object.keys(obj).some(key =>
    key.toLowerCase().includes(searchText.toLowerCase())
  );
  
  return valueMatch || keyMatch;
}
```

---

**ç°åœ¨æµ‹è¯•å¹¶æŠŠå®Œæ•´çš„ Console æ—¥å¿—å‘ç»™æˆ‘ï¼** ğŸ”

ç‰¹åˆ«æ˜¯ï¼š
- `å“åº”æ•°æ®é¢„è§ˆ` é‡Œæœ‰æ²¡æœ‰ `104`ï¼Ÿ
- `åŒ¹é…ç»“æœ` æ˜¯ `true` è¿˜æ˜¯ `false`ï¼Ÿ
- æœ‰æ²¡æœ‰çœ‹åˆ° `âœ… æ‰¾åˆ°åŒ¹é…`ï¼Ÿ
