# âœ… äº¤äº’æ–¹å¼é‡æ–°è®¾è®¡ - æ‚¬åœå³æ˜¾ç¤º

## ğŸ¯ æ–°çš„äº¤äº’é€»è¾‘

### ä¹‹å‰çš„æ–¹å¼ï¼ˆæœ‰é—®é¢˜ï¼‰
```
ç‚¹å‡»å…ƒç´  â†’ å¼¹å‡ºé¢æ¿ â†’ å†ç‚¹å‡»é¢æ¿ä¼šè¢«è¯¯è¿½è¸ª âŒ
```

### ç°åœ¨çš„æ–¹å¼ï¼ˆç®€åŒ–ï¼‰
```
é¼ æ ‡æ‚¬åœ â†’ ç«‹å³æ˜¾ç¤ºæ•°æ®æ¥æºæç¤ºæ¡† âœ…
ç‚¹å‡»å…ƒç´  â†’ æ˜¾ç¤ºå®Œæ•´æ•°æ®é¢æ¿ï¼ˆå¯é€‰ï¼‰âœ…
```

---

## ğŸ¨ UI è®¾è®¡

### 1. æ‚¬åœæç¤ºæ¡†ï¼ˆTooltipï¼‰

**æ‰¾åˆ°æ•°æ®æ¥æº**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¡ æ‰¾åˆ° 2 ä¸ªæ•°æ®æ¥æº               â”‚
â”‚                                    â”‚
â”‚ GET 200 (3 åŒ¹é…)                   â”‚
â”‚ /api/stations/id/201               â”‚
â”‚                                    â”‚
â”‚ POST 200 (1 åŒ¹é…)                  â”‚
â”‚ /api/query/station                 â”‚
â”‚                                    â”‚
â”‚ ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨...                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœªæ‰¾åˆ°æ•°æ®æ¥æº**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ æœªæ‰¾åˆ°æ•°æ®æ¥æº      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å®Œæ•´é¢æ¿ï¼ˆç‚¹å‡»åï¼‰

ç‚¹å‡»å…ƒç´ åï¼Œä»ç„¶å¯ä»¥çœ‹åˆ°å®Œæ•´çš„æ•°æ®é¢æ¿ï¼ˆä¿ç•™åŸåŠŸèƒ½ï¼‰ã€‚

---

## ğŸ”„ å·¥ä½œæµç¨‹

### ç”¨æˆ·æ“ä½œæµç¨‹

```
1. ç‚¹å‡»"å¯åŠ¨æ£€æŸ¥å™¨"
   â†“
2. é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºæç¤ºï¼š"ç§»åŠ¨é¼ æ ‡æŸ¥çœ‹å…ƒç´ æ•°æ®æ¥æº"
   â†“
3. ç§»åŠ¨é¼ æ ‡åˆ°é¡µé¢å…ƒç´ 
   â†“
4. å…ƒç´ é«˜äº® + ä¸‹æ–¹æ˜¾ç¤ºæ•°æ®æ¥æºæç¤ºæ¡†
   â†“
5. ç§»å¼€é¼ æ ‡
   â†“
6. æç¤ºæ¡†æ¶ˆå¤±
   â†“
7. ï¼ˆå¯é€‰ï¼‰ç‚¹å‡»å…ƒç´ æŸ¥çœ‹å®Œæ•´é¢æ¿
```

---

## ğŸ’¡ ä¼˜åŠ¿

### 1. å³æ—¶åé¦ˆ âš¡
- ä¸éœ€è¦ç‚¹å‡»å°±èƒ½çœ‹åˆ°æ•°æ®æ¥æº
- æ‚¬åœå³æ˜¾ç¤ºï¼Œé€Ÿåº¦å¿«
- é€‚åˆå¿«é€Ÿæ‰«æé¡µé¢

### 2. æ— å¹²æ‰° ğŸ¯
- æç¤ºæ¡†è·Ÿéšå…ƒç´ ä½ç½®
- ç§»å¼€é¼ æ ‡è‡ªåŠ¨æ¶ˆå¤±
- ä¸ä¼šé˜»æŒ¡é¡µé¢å†…å®¹

### 3. ç®€åŒ–æ“ä½œ âœ¨
- ä¸»è¦äº¤äº’ï¼šåªéœ€ç§»åŠ¨é¼ æ ‡
- æ¬¡è¦äº¤äº’ï¼šç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…
- ç¬¦åˆç”¨æˆ·ç›´è§‰

### 4. é¿å…è¯¯æ“ä½œ ğŸ›¡ï¸
- ä¸å†æœ‰"ç‚¹å‡»é¢æ¿"çš„é—®é¢˜
- æç¤ºæ¡† `pointer-events: none` ä¸å¯ç‚¹å‡»
- é¢æ¿åªåœ¨éœ€è¦æ—¶æ˜¾ç¤º

---

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒä»£ç 

```javascript
handleMouseOver = async (e) => {
  // 1. é«˜äº®å…ƒç´ 
  this.highlightElement(element);
  
  // 2. ç«‹å³æŸ¥æ‰¾æ•°æ®æ¥æº
  const elementText = this.extractElementText(element);
  const sources = this.findDataSources(elementText);
  
  // 3. æ˜¾ç¤ºæç¤ºæ¡†
  this.showDataSourceTooltip(element, sources);
}

handleMouseOut = (e) => {
  // æ¸…é™¤é«˜äº®å’Œæç¤ºæ¡†
  this.clearHighlight();
  this.hideDataSourceTooltip();
}

handleClick = async (e) => {
  // ç‚¹å‡»æ—¶æ˜¾ç¤ºå®Œæ•´é¢æ¿ï¼ˆå¯é€‰ï¼‰
  if (sources.length > 0) {
    this.showDataSourcePanel(element, sources);
  }
}
```

### æç¤ºæ¡†ç‰¹æ€§

```javascript
tooltip.style.cssText = `
  position: fixed;
  pointer-events: none;  // âœ… ä¸å¯ç‚¹å‡»ï¼Œé¼ æ ‡ç©¿é€
  z-index: 2147483646;   // é«˜å±‚çº§ä½†ä½äºé¢æ¿
`;
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### åŸºç¡€åŠŸèƒ½æµ‹è¯•

```bash
1ï¸âƒ£ é‡æ–°åŠ è½½æ‰©å±•
   chrome://extensions/ â†’ SPX Helper â†’ ğŸ”„

2ï¸âƒ£ åˆ·æ–°æµ‹è¯•é¡µé¢
   F5

3ï¸âƒ£ å¯åŠ¨æ£€æŸ¥å™¨
   ğŸ¯ å¯åŠ¨æ£€æŸ¥å™¨

4ï¸âƒ£ ç§»åŠ¨é¼ æ ‡åˆ°é¡µé¢å…ƒç´ 
   âœ… å…ƒç´ é«˜äº®ï¼ˆç´«è‰²è¾¹æ¡†ï¼‰
   âœ… ä¸‹æ–¹æ˜¾ç¤ºæç¤ºæ¡†
   
5ï¸âƒ£ æµ‹è¯•æœ‰æ•°æ®çš„å…ƒç´ 
   ç§»åŠ¨åˆ°è¡¨æ ¼è¡Œã€å¡ç‰‡ç­‰
   âœ… æç¤ºæ¡†æ˜¾ç¤º"ğŸ“¡ æ‰¾åˆ° X ä¸ªæ•°æ®æ¥æº"
   âœ… æ˜¾ç¤º API æ–¹æ³•å’Œ URL
   
6ï¸âƒ£ æµ‹è¯•æ— æ•°æ®çš„å…ƒç´ 
   ç§»åŠ¨åˆ°æ ‡é¢˜ã€æŒ‰é’®ç­‰
   âœ… æç¤ºæ¡†æ˜¾ç¤º"âš ï¸ æœªæ‰¾åˆ°æ•°æ®æ¥æº"
   
7ï¸âƒ£ ç§»å¼€é¼ æ ‡
   âœ… æç¤ºæ¡†æ¶ˆå¤±
   âœ… é«˜äº®æ¶ˆå¤±
   
8ï¸âƒ£ ç‚¹å‡»å…ƒç´ ï¼ˆå¯é€‰ï¼‰
   âœ… æ˜¾ç¤ºå®Œæ•´æ•°æ®é¢æ¿
   âœ… å¯ä»¥æŸ¥çœ‹åŒ¹é…è¯¦æƒ…
   âœ… å¯ä»¥æŸ¥çœ‹å®Œæ•´å“åº”
```

### äº¤äº’æµç•…æ€§æµ‹è¯•

```bash
1ï¸âƒ£ å¿«é€Ÿç§»åŠ¨é¼ æ ‡
   åœ¨å¤šä¸ªå…ƒç´ é—´å¿«é€Ÿç§»åŠ¨
   âœ… æç¤ºæ¡†è·Ÿéšå…ƒç´ 
   âœ… ä¸ä¼šæ®‹ç•™
   
2ï¸âƒ£ ç§»åˆ°æç¤ºæ¡†ä¸Š
   âœ… é¼ æ ‡ç©¿é€æç¤ºæ¡†
   âœ… ä¸‹é¢çš„å…ƒç´ ä»ç„¶å¯ä»¥äº¤äº’
   
3ï¸âƒ£ è¿ç»­ç§»åŠ¨
   ä¸åœç§»åŠ¨é¼ æ ‡
   âœ… æ€§èƒ½è‰¯å¥½
   âœ… ä¸å¡é¡¿
```

---

## ğŸ“Š å¯¹æ¯”

### Beforeï¼ˆç‚¹å‡»æ¨¡å¼ï¼‰

| æ“ä½œ | æ­¥éª¤ | é—®é¢˜ |
|------|------|------|
| æŸ¥çœ‹æ•°æ® | ç‚¹å‡» â†’ ç­‰å¾…é¢æ¿ | âŒ éœ€è¦ç‚¹å‡» |
| æŸ¥çœ‹å¤šä¸ª | ç‚¹å‡» â†’ å…³é—­ â†’ ç‚¹å‡»... | âŒ ç¹ç |
| è¯¯æ“ä½œ | ç‚¹åˆ°é¢æ¿ | âŒ å¼¹å‡ºæ–°é¢æ¿ |

### Afterï¼ˆæ‚¬åœæ¨¡å¼ï¼‰

| æ“ä½œ | æ­¥éª¤ | ä¼˜åŠ¿ |
|------|------|------|
| æŸ¥çœ‹æ•°æ® | æ‚¬åœ | âœ… å³æ—¶æ˜¾ç¤º |
| æŸ¥çœ‹å¤šä¸ª | æ‚¬åœ â†’ æ‚¬åœ â†’ æ‚¬åœ | âœ… è¿ç»­å¿«é€Ÿ |
| è¯¯æ“ä½œ | æ—  | âœ… æç¤ºæ¡†ä¸å¯ç‚¹ |

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å¿«é€Ÿæ‰«æ
```
ç”¨æˆ·æƒ³çŸ¥é“é¡µé¢å“ªäº›æ•°æ®æ¥è‡ª API

æ“ä½œï¼š
1. å¯åŠ¨æ£€æŸ¥å™¨
2. å¿«é€Ÿç§»åŠ¨é¼ æ ‡æ‰«æé¡µé¢
3. çœ‹åˆ°æœ‰"ğŸ“¡"å›¾æ ‡çš„å°±æ˜¯ API æ•°æ®
4. çœ‹åˆ°"âš ï¸"çš„å°±æ˜¯ç¡¬ç¼–ç 
```

### åœºæ™¯2: å®šä½æ•°æ®æº
```
ç”¨æˆ·å‘ç°ä¸€ä¸ªæ•°æ®é”™è¯¯ï¼Œæƒ³çŸ¥é“æ¥è‡ªå“ªä¸ª API

æ“ä½œï¼š
1. å¯åŠ¨æ£€æŸ¥å™¨
2. ç§»åŠ¨åˆ°é”™è¯¯æ•°æ®çš„å…ƒç´ 
3. æç¤ºæ¡†æ˜¾ç¤º API URL
4. ç‚¹å‡»å…ƒç´ æŸ¥çœ‹å®Œæ•´ä¿¡æ¯
5. å¤åˆ¶ URL å»ä¿®æ”¹
```

### åœºæ™¯3: å­¦ä¹ é¡µé¢ç»“æ„
```
æ–°å‘˜å·¥æƒ³äº†è§£é¡µé¢æ•°æ®æµ

æ“ä½œï¼š
1. å¯åŠ¨æ£€æŸ¥å™¨
2. ç§»åŠ¨é¼ æ ‡æµè§ˆæ•´ä¸ªé¡µé¢
3. è§‚å¯Ÿå“ªäº›å…ƒç´ æœ‰æ•°æ®æ¥æº
4. ç†è§£é¡µé¢æ¶æ„
```

---

## ğŸ’» ä»£ç ç»†èŠ‚

### showDataSourceTooltip()

```javascript
showDataSourceTooltip(element, sources) {
  // è®¡ç®—ä½ç½®
  const rect = element.getBoundingClientRect();
  
  // åˆ›å»ºæç¤ºæ¡†
  const tooltip = document.createElement('div');
  tooltip.id = 'spx-api-tracker-tooltip';
  
  if (sources.length === 0) {
    // æ©™è‰²ï¼šæœªæ‰¾åˆ°
    tooltip.style.background = 'rgba(255, 152, 0, 0.95)';
    tooltip.innerHTML = `âš ï¸ æœªæ‰¾åˆ°æ•°æ®æ¥æº`;
  } else {
    // è“è‰²ï¼šæ‰¾åˆ°äº†
    tooltip.style.background = 'rgba(102, 126, 234, 0.95)';
    // æ˜¾ç¤ºå‰3ä¸ª API
    // è¶…è¿‡3ä¸ªæ˜¾ç¤º"ç‚¹å‡»æŸ¥çœ‹å…¨éƒ¨"
  }
  
  // pointer-events: none é¼ æ ‡ç©¿é€
  document.body.appendChild(tooltip);
}
```

### æ€§èƒ½ä¼˜åŒ–

```javascript
// æ¯æ¬¡ mouseover éƒ½ä¼šè§¦å‘
handleMouseOver = async (e) => {
  // âœ… ä¼˜åŒ–1: æ£€æŸ¥æ˜¯å¦å·²ç»åœ¨è¿™ä¸ªå…ƒç´ ä¸Š
  if (this.highlightedElement === element) return;
  
  // âœ… ä¼˜åŒ–2: æ–‡æœ¬æå–æœ‰é•¿åº¦é™åˆ¶
  const directText = element.textContent?.trim();
  if (directText && directText.length < 200) { ... }
  
  // âœ… ä¼˜åŒ–3: åªæ˜¾ç¤ºå‰3ä¸ª API
  const apiList = sources.slice(0, 3).map(...);
}
```

---

## ğŸ¨ UI è°ƒæ•´

### æç¤ºæ¡†ä½ç½®
- é»˜è®¤ï¼šå…ƒç´ ä¸‹æ–¹ 10px
- å¦‚æœä¸‹æ–¹ç©ºé—´ä¸è¶³ï¼šè‡ªåŠ¨è°ƒæ•´åˆ°ä¸Šæ–¹
- æ°´å¹³å¯¹é½ï¼šä¸å…ƒç´ å·¦è¾¹ç¼˜å¯¹é½

### é¢œè‰²æ–¹æ¡ˆ
- æ‰¾åˆ°æ•°æ®ï¼šè“è‰² `rgba(102, 126, 234, 0.95)`
- æœªæ‰¾åˆ°ï¼šæ©™è‰² `rgba(255, 152, 0, 0.95)`
- é«˜äº®è¾¹æ¡†ï¼šç´«è‰² `#667eea`

### å­—ä½“å¤§å°
- æç¤ºæ¡†ä¸»æ–‡å­—ï¼š12px
- API URLï¼š10px
- åŒ¹é…æ•°é‡ï¼š10px

---

## ğŸš€ ç°åœ¨æµ‹è¯•

```bash
1ï¸âƒ£ é‡æ–°åŠ è½½æ‰©å±•ï¼ˆå¿…é¡»ï¼ï¼‰
2ï¸âƒ£ åˆ·æ–°é¡µé¢
3ï¸âƒ£ å¯åŠ¨æ£€æŸ¥å™¨
4ï¸âƒ£ ç§»åŠ¨é¼ æ ‡åˆ°å„ç§å…ƒç´ 
5ï¸âƒ£ è§‚å¯Ÿæç¤ºæ¡†
6ï¸âƒ£ äº«å—æµç•…çš„ä½“éªŒï¼âœ¨
```

---

**æ–°çš„äº¤äº’æ–¹å¼æ›´ç›´è§‚ã€æ›´å¿«é€Ÿã€æ›´å¥½ç”¨ï¼** ğŸ‰
