# 🪟 窗口模式支持 - API 详情查看

## ✅ 新功能

自动检测窗口模式，智能选择显示方式：

- **弹出模式** → 在当前弹窗中显示
- **窗口模式** → 在新浏览器窗口中打开

---

## 🎯 实现原理

### 检测窗口模式

```javascript
// 通过 URL 参数判断
const isWindowMode = new URLSearchParams(window.location.search).get('mode') === 'window';

if (isWindowMode) {
  // 在新窗口中打开
  openAPIDetailInNewWindow(record);
} else {
  // 在弹窗中显示
  showAPIDetailInPopup(record);
}
```

### 新窗口打开

```javascript
const newWindow = window.open('', '_blank', 'width=900,height=700');
newWindow.document.write(`... 完整的 HTML ...`);
```

---

## 🎨 新窗口 UI

### 布局
- **容器宽度**: 900px × 700px
- **内容最大宽度**: 1200px
- **响应式网格**: 4列信息卡片

### 样式
- ✅ 白色背景 + 卡片设计
- ✅ 紫色主题色 (#667eea)
- ✅ 深色代码区域 (#1e1e1e)
- ✅ 悬停动画效果
- ✅ 响应式布局

### 功能
- 📡 完整的 URL 显示
- ⏱️ 请求信息（4个卡片）
- 📦 JSON 响应（语法高亮）
- 📋 复制按钮（带成功提示）
- ✕ 关闭窗口按钮

---

## 🔍 两种模式对比

| 特性 | 弹出模式 | 窗口模式 |
|------|----------|----------|
| **显示位置** | 扩展弹窗内 | 新浏览器窗口 |
| **窗口大小** | 受弹窗限制 | 900×700 可调整 |
| **适用场景** | 快速查看 | 详细分析 |
| **多窗口** | 不支持 | 可同时打开多个 |
| **复制数据** | ✅ | ✅ |

---

## 🧪 测试步骤

### 测试 1: 弹出模式（默认）

```bash
1️⃣ 点击扩展图标（弹出模式）
2️⃣ 实用工具 → API溯源
3️⃣ 点击任意 API
```

**预期**：在弹窗内显示详情

### 测试 2: 窗口模式

```bash
1️⃣ 打开扩展窗口模式
   右键扩展图标 → 以窗口模式打开

2️⃣ 实用工具 → API溯源
3️⃣ 点击任意 API
```

**预期**：在新窗口中打开详情

---

## 💡 窗口模式优势

### 1. 更大的显示空间
```
弹出模式: ~400px × 600px
窗口模式: 900px × 700px (可调整)
```

### 2. 多窗口对比
```
可以同时打开多个 API 详情窗口
方便对比不同 API 的响应数据
```

### 3. 独立操作
```
不会因为关闭扩展而关闭详情
可以随时切回扩展查看其他 API
```

---

## 🎉 窗口模式特性

### 完整页面布局
```html
<!DOCTYPE html>
<html>
  <head>
    <title>API 响应详情 - GET 200</title>
    <style>...</style>
  </head>
  <body>
    <div class="container">
      <div class="header">...</div>
      <div class="section">📡 URL</div>
      <div class="section">⏱️ 信息</div>
      <div class="section">📦 响应</div>
      <button>✕ 关闭</button>
    </div>
  </body>
</html>
```

### 交互功能
- ✅ 复制按钮（带成功提示动画）
- ✅ 关闭按钮（关闭窗口）
- ✅ 滚动查看（响应数据）
- ✅ 响应式布局（窗口缩放）

---

## 📋 完整流程

```
用户在窗口模式下打开扩展
         ↓
点击 API 列表中的某个 API
         ↓
检测到 mode=window
         ↓
调用 openAPIDetailInNewWindow()
         ↓
window.open() 打开新窗口
         ↓
document.write() 写入完整 HTML
         ↓
显示详情页面
         ↓
用户可以：
  - 查看完整数据
  - 复制响应
  - 关闭窗口
```

---

## 🎨 UI 预览

### 新窗口布局
```
┌────────────────────────────────────────┐
│  🔍 API 响应详情                       │
│  [GET] [200] ⏱️ 234ms 🕐 10:30:45     │
├────────────────────────────────────────┤
│  📡 请求 URL                            │
│  ┌──────────────────────────────────┐  │
│  │ https://api_mart/mgmt_app/data  │  │
│  └──────────────────────────────────┘  │
│                                        │
│  ⏱️ 请求信息                            │
│  ┌──────┬──────┬──────┬──────┐        │
│  │方法  │状态  │耗时  │时间  │        │
│  │GET   │200   │234ms │...   │        │
│  └──────┴──────┴──────┴──────┘        │
│                                        │
│  📦 响应数据           [📋 复制]      │
│  ┌──────────────────────────────────┐ │
│  │ {                                │ │
│  │   "retcode": 0,                  │ │
│  │   "data": { ... }                │ │
│  │ }                                │ │
│  └──────────────────────────────────┘ │
│                                        │
│  [✕ 关闭窗口]                         │
└────────────────────────────────────────┘
```

---

## 🚀 优势总结

1. **智能检测** - 自动适配显示模式
2. **更大空间** - 窗口模式提供更大显示区域
3. **独立操作** - 不影响扩展主窗口
4. **多窗口** - 可同时打开多个 API 详情
5. **完整功能** - 复制、关闭、滚动查看

---

**现在测试窗口模式！** 🪟

在窗口模式下点击 API，应该会在新的浏览器窗口中打开详情！
